(function(){var F,l,C=function(a,c){var b,g,e,d,h,f,i,j,k,n=c&&c.split("/"),B=p.map,m=B&&B["*"]||{};if(a&&"."===a.charAt(0)&&c){n=n.slice(0,n.length-1);a=n.concat(a.split("/"));for(j=0;j<a.length;j+=1)if(b=a[j],"."===b)a.splice(j,1),j-=1;else if(".."===b)if(1===j&&(".."===a[2]||".."===a[0]))break;else 0<j&&(a.splice(j-1,2),j-=2);a=a.join("/")}if((n||m)&&B){b=a.split("/");for(j=b.length;0<j;j-=1){g=b.slice(0,j).join("/");if(n)for(k=n.length;0<k;k-=1)if(e=B[n.slice(0,k).join("/")])if(e=e[g]){d=e;h=
j;break}if(d)break;!f&&(m&&m[g])&&(f=m[g],i=j)}!d&&f&&(d=f,h=i);d&&(b.splice(0,h,d),a=b.join("/"))}return a},G=function(a,c){return function(){return v.apply(void 0,K.call(arguments,0).concat([a,c]))}},L=function(a){return function(c){return C(c,a)}},M=function(a){return function(c){o[a]=c}},D=function(a){if(w.hasOwnProperty(a)){var c=w[a];delete w[a];H[a]=!0;x.apply(void 0,c)}if(!o.hasOwnProperty(a))throw Error("No "+a);return o[a]},I=function(a,c){var b,g,e=a.indexOf("!");-1!==e?(b=C(a.slice(0,
e),c),a=a.slice(e+1),a=(g=D(b))&&g.normalize?g.normalize(a,L(c)):C(a,c)):a=C(a,c);return{f:b?b+"!"+a:a,n:a,p:g}},N=function(a){return function(){return p&&p.config&&p.config[a]||{}}},x,v,o={},w={},p={},H={},K=[].slice;x=function(a,c,b,g){var e,d,h,f,i=[],j,g=g||a;if("function"===typeof b){c=!c.length&&b.length?["require","exports","module"]:c;for(f=0;f<c.length;f+=1)if(h=I(c[f],g),d=h.f,"require"===d)i[f]=G(a);else if("exports"===d)i[f]=o[a]={},j=!0;else if("module"===d)e=i[f]={id:a,uri:"",exports:o[a],
config:N(a)};else if(o.hasOwnProperty(d)||w.hasOwnProperty(d))i[f]=D(d);else if(h.p)h.p.load(h.n,G(g,!0),M(d),{}),i[f]=o[d];else if(!H[d])throw Error(a+" missing "+d);c=b.apply(o[a],i);if(a)if(e&&void 0!==e.exports&&e.exports!==o[a])o[a]=e.exports;else if(void 0!==c||!j)o[a]=c}else a&&(o[a]=b)};F=v=function(a,c,b,g,e){if("string"===typeof a)return D(I(a,c).f);a.splice||(p=a,c.splice?(a=c,c=b,b=null):a=void 0);c=c||function(){};"function"===typeof b&&(b=g,g=e);g?x(void 0,a,c,b):setTimeout(function(){x(void 0,
a,c,b)},15);return v};v.config=function(a){p=a;return v};l=function(a,c,b){c.splice||(b=c,c=[]);w[a]=[a,c,b]};l.amd={jQuery:!0};l("vendor/almond",[],function(){});l("tiles_factory",[],function(){function a(a,c,e){var d,h,f,i;if(c.widthT!==a.widthT||c.heightT!==a.heightT)return!1;for(d=0;d<c.length;d+=1){f=c[d];i=a[d];for(h=0;h<f.length;h+=1)if(!e(f[h],i[h]))return!1}return!0}var c;c=Object.create([],{areEqualTo:{value:function(b){return a(this,b,function(a,b){return a===b})}},colorsAreEqualTo:{value:function(b){return a(this,
b,function(a,b){return a.color===b.color})}},widthT:{get:function(){return this.length}},heightT:{get:function(){return 0<this.widthT?this[0].length:0}},copy:{value:function(){var a=Object.create(c);this.forEach(function(c){a.push(c.slice())});return a}}});return Object.create(null,{load:{value:function(a,g){var e=new Image;e.onload=function(){var a=document.createElement("canvas"),b=a.getContext("2d");a.width=e.width;a.height=e.height;b.drawImage(e,0,0);var f,i,j,k,a=Math.min(e.width,e.height),n=
b.getImageData(0,0,a,a).data,b=Object.create(c);for(i=0;i<a;i+=1){f=[];for(j=0;j<a;j+=1)k=4*(j*a+i),f.push({color:"rgb("+n[k]+","+n[k+1]+","+n[k+2]+")"});b.push(f)}g(b)};e.src=a}}})});l("hiscores_factory",[],function(){var a=[{name:"Roger",nRotations:6},{name:"Larry",nRotations:8},{name:"Zak",nRotations:9},{name:"Mario",nRotations:10},{name:"Gianna",nRotations:11},{name:"Sonya",nRotations:30},{name:"Johnny",nRotations:42}].slice(0,7),c="";return Object.create(null,{load:{value:function(b,g){var e,
d=null;e=a.slice();g(Object.create(null,{forEach:{value:function(a){var f,b,c=e.length,g=!1;for(f=0;f<c;f+=1)b=e[f],null!==d&&d.nRotations<=b.nRotations&&!g?(a(d,f,!0),f-=1,c-=1,g=!0):a(b,f,!1)}},maxNameLen:{get:function(){return 8}},nameInProposal:{set:function(a){null!==d&&(a=a.substring(0,this.maxNameLen),c=d.name=a)}},saveProposal:{value:function(){if(null!==d){a:{var a=d,f,b,c=!1;if(""!==a.name)for(f=0;f<e.length;f+=1){b=e[f];if(a.name===b.name&&a.nRotations>=b.nRotations)break a;a.nRotations<=
b.nRotations&&!c?(e.splice(f,0,a),c=!0):a.name===b.name&&e.splice(f,1)}e.length=Math.min(e.length,7)}d=null}}},propose:{value:function(a){d={name:c,rotations:a.slice(),nRotations:a.length}}},rmProposal:{value:function(){d=null}}}))}}})});l("board_factory",["tiles_factory","hiscores_factory"],function(a,c){function b(a){return void 0!==a.tiles&&void 0!==a.endTiles&&void 0!==a.hiscores}function g(a,b){Object.defineProperty(a,"sideLenT",{value:a.tiles.length});b(a)}function e(a,b,f,c){return a[f][c-
b]}function d(a,b,f,c,e){return a[e-f][b]}function h(a,b,f,c,e){return a[c-b][e-f]}function f(a,b,f){var c,e,d=b[0][0],g=b[0][1],h=b[1][0],b=b[1][1],j=h-d,i=b-g,k,l;k=[];for(e=d;e<=h;e+=1){c=[];for(l=g;l<=b;l+=1)c.push(a[e][l]);k.push(c)}for(c=d;c<=h;c+=1)for(e=g;e<=b;e+=1)a[c][e]=f(k,c-d,e-g,j,i)}function i(a,b){var c=b.rectT,g=b.cw;c.isSquare?g?f(a,c,e):f(a,c,d):f(a,c,h)}function j(a,b){b.tiles.colorsAreEqualTo(b.endTiles)?a.isFinished||(a.isFinished=!0,b.hiscores.propose(a.rotations)):(a.isFinished=
!1,b.hiscores.rmProposal())}var k;k=Object.create(null,{rotate:{value:function(a,b){a.rotations.push(b);a.futureRotations.length=0;i(this.tiles,b);j(a,this);a.lastRotation=b}},undo:{value:function(a){var b=a.rotations.pop();void 0!==b&&(a.futureRotations.push(b),i(this.tiles,b.inverse),j(a,this),a.lastRotation=b.inverse)}},redo:{value:function(a){var b=a.futureRotations.pop();void 0!==b&&(a.rotations.push(b),i(this.tiles,b),j(a,this),a.lastRotation=b)}}});return Object.create(null,{load:{value:function(f,
e){var d,h={rotations:[],futureRotations:[],lastRotation:null,isFinished:!1};d=Object.create(k,{rotate:{value:function(a){k.rotate.call(this,h,a)}},nRotations:{get:function(){return h.rotations.length}},undoIsPossible:{get:function(){return 0<h.rotations.length}},undo:{value:function(){k.undo.call(this,h)}},redoIsPossible:{get:function(){return 0<h.futureRotations.length}},redo:{value:function(){k.redo.call(this,h)}},isFinished:{get:function(){return h.isFinished}},lastRotation:{get:function(){return h.lastRotation}}});
a.load("boards/"+f+"/start.gif",function(a){Object.defineProperty(d,"tiles",{value:a});b(d)&&g(d,e)});a.load("boards/"+f+"/end.gif",function(a){Object.defineProperty(d,"endTiles",{value:a});b(d)&&g(d,e)});c.load("boards/hiscores.json/undefined",function(a){Object.defineProperty(d,"hiscores",{value:a});b(d)&&g(d,e)})}}})});l("boards",["board_factory"],function(a){var c=0,b,g="13 smiley invaders house dogman rgbcmy".split(" ");return b=Object.create([],{load:{value:function(c){this.length=g.length;
g.forEach(function(d,h){a.load(d,function(a){b[h]=a;a:{for(a=0;a<g.length;a+=1)if(void 0===b[a]){a=!1;break a}a=!0}a&&c()})})}},selected:{get:function(){return this[c]}},selectedI:{get:function(){return c},set:function(a){c=a}}})});l("util",[],function(){return Object.create(null,{whenDocumentIsReady:{value:function(a){"complete"===document.readyState?a():document.addEventListener("readystatechange",function(){"complete"===document.readyState&&a()})}},clear:{value:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)}}})});
l("rect_t_factory",[],function(){var a,c;c=function(a,c){return a[0]===c[0]&&a[1]===c[1]};a=Object.create([],{isEqualTo:{value:function(a){return c(this[0],a[0])&&c(this[1],a[1])}},widthT:{get:function(){return this[1][0]-this[0][0]}},heightT:{get:function(){return this[1][1]-this[0][1]}},centerT:{get:function(){return[(this[0][0]+this[1][0])/2,(this[0][1]+this[1][1])/2]}},contains:{value:function(a){var c=a[0],a=a[1];return c>=this[0][0]&&a>=this[0][1]&&c<=this[1][0]&&a<=this[1][1]}},isSquare:{get:function(){return this.widthT===
this.heightT}}});return Object.create(null,{create:{value:function(b,c){var e=Object.create(a);e.push(b);e.push(c);return e}}})});l("display_c_sys",["boards"],function(a){function c(){var a;void 0!==g&&(a=g.sideLenT,d=h?0:0.05*b/a,e=(b-d*(a+1))/a)}var b,g,e=0,d=0,h=!1;return Object.create(null,{sideLen:{set:function(a){a!==b&&(b=a,c())}},animStep:{value:function(){a.selected!==g&&(g=a.selected,c())}},posFromPosT:{value:function(a){return a.map(function(a){return a*(e+d)+d})}},posTFromPos:{value:function(a){return a.map(function(a){return(a-
d)/(e+d)})}},decIfInSpacing:{value:function(a){return a.map(function(a){var b=a%(e+d);return 0<a&&b<d?a-b-e/2:a})}},incIfInSpacing:{value:function(a){return a.map(function(a){var b=a%(e+d);return 0<a&&b<d?a-b+d+e/2:a})}},posTInBounds:{value:function(a){return a.map(function(a){return Math.min(Math.max(a,0),g.sideLenT-1)})}},tileSideLen:{get:function(){return e}},spacing:{get:function(){return d}},disableSpacing:{value:function(){h=!0;c()}},enableSpacing:{value:function(){h=!1;c()}}})});l("display_canvas_factory",
[],function(){return Object.create(null,{create:{value:function(){var a=!0,c=!0;return Object.create(null,{visibilityNeedsToBeUpdated:{get:function(){return c}},isVisible:{get:function(){return a}},updateVisibility:{value:function(b){b.style.display=a?"block":"none";c=!1}},show:{value:function(){a||(c=a=!0)}},hide:{value:function(){a&&(a=!1,c=!0)}}})}}})});l("rubber_band_canvas",["util","rect_t_factory","display_c_sys","display_canvas_factory"],function(a,c,b,g){function e(){var a=b.incIfInSpacing([Math.min(q[0],
r[0]),Math.min(q[1],r[1])]),e=b.decIfInSpacing([Math.max(q[0],r[0]),Math.max(q[1],r[1])]),a=b.posTInBounds(b.posTFromPos(a).map(Math.floor)),e=b.posTInBounds(b.posTFromPos(e).map(Math.floor));t=c.create(a,e)}function d(){y=r[0]>q[0]}function h(a){r=q=a;e();d();z=A=!0;void 0!==u&&u()}function f(a){r=a;e();d();z=!0;void 0!==E&&E(t,y)}function i(){A=!1;z=!0;q=r=[0,0];e();d();void 0!==p&&p()}function j(a){h([a.pageX,a.pageY])}function k(a){var b=a.changedTouches;a.preventDefault();0<b.length&&h([b[0].pageX,
b[0].pageY])}function n(a){A&&f([a.pageX,a.pageY])}function B(a){var b=a.changedTouches;a.preventDefault();A&&0<b.length&&f([b[0].pageX,b[0].pageY])}function m(){A&&i()}function l(a){a.preventDefault();A&&i()}var s,q=[0,0],r=[0,0],t=c.create([0,0],[0,0]),y,z=!0,A=!1,o=1,E,u,p;a.whenDocumentIsReady(function(){var a=document.getElementById("rubberBandCanvas");a.addEventListener("mousedown",j);a.addEventListener("touchstart",k);window.addEventListener("mousemove",n);window.addEventListener("touchmove",
B);window.addEventListener("mouseup",m);window.addEventListener("touchend",l);window.addEventListener("touchcancel",l)});return Object.create(g.create(),{animStep:{value:function(){var a=document.getElementById("rubberBandCanvas");this.visibilityNeedsToBeUpdated&&(this.updateVisibility(a),this.isVisible&&(z=!0));if(z){var b=a.getContext("2d");a.height=a.width=s;o=0.005*s;b.strokeStyle="#fff";b.lineWidth=o;b.lineJoin="round";b.strokeRect(q[0],q[1],r[0]-q[0],r[1]-q[1]);z=!1}}},isBeingDragged:{get:function(){return A}},
sideLen:{set:function(a){a!==s&&(s=a,z=!0)}},onDragStart:{set:function(a){u=a}},onDrag:{set:function(a){E=a}},onDragEnd:{set:function(a){p=a}}})});l("rot_anim_canvas",["boards","display_c_sys","display_canvas_factory"],function(a,c,b){var g,e,d,h,f,i,j,k,n;return Object.create(b.create(),{animStep:{value:function(){var a=document.getElementById("rotAnimCanvas");this.visibilityNeedsToBeUpdated&&this.updateVisibility(a);if(d){j=i+0.004*k*(Date.now()-f);if(0>k?0>=j:0<=j)j=0;if(0>k?0>=j:0<=j)d=!1,this.hide();
else{var b,n=a.getContext("2d");b=h[0][0];var s=h[0][1],q=h[1][0],r=h[1][1],t=c.posFromPosT(h.centerT),t=[t[0]+c.tileSideLen/2,t[1]+c.tileSideLen/2];a.width=a.height=g;n.save();n.translate(t[0],t[1]);n.rotate(j);for(a=b;a<=q;a+=1)for(b=s;b<=r;b+=1){var y=n,l=[a,b],o=t,p=c.posFromPosT(l),E=c.tileSideLen;y.fillStyle=e[l[0]][l[1]].color;y.fillRect(p[0]-o[0],p[1]-o[1],E,E)}n.restore()}}}},sideLen:{set:function(a){g=a}},animIsRunning:{get:function(){return d}},isInRotRect:{value:function(a){return h.contains(a)}},
startAnim:{value:function(b){n=a.selected;e=n.tiles.copy();h=b.rectT;d=!0;f=Date.now();k=-b.direction;i=b.angleRad;this.show()}}})});l("arrow_canvas",["display_c_sys","display_canvas_factory"],function(a,c){var b,g=!1,e,d;d=Object.create(c.create(),{animStep:{value:function(){var c=document.getElementById("arrowCanvas");this.visibilityNeedsToBeUpdated&&(this.updateVisibility(c),this.isVisible&&(g=!0));if(g){var f=c.getContext("2d");c.height=c.width=b;if(void 0!==e&&e.makesSense){var d=e.angleDeg,
j=a.posFromPosT(e.rectT[1]),c=j[0],j=j[1],k=a.tileSideLen/14;f.lineWidth=k;var n=90===d||-90===d?Math.PI/2:Math.PI;f.beginPath();f.arc(c+10*k,j+10*k,1.5*k,0,n);f.stroke();f.beginPath();90===d||180===d||-180===d?(d=-180===d?-3*k:0,f.moveTo(c+10*k+d,j+10*k),f.lineTo(c+13*k+d,j+10*k),f.lineTo(c+11.5*k+d,j+8*k),f.lineTo(c+10*k+d,j+10*k)):(f.moveTo(c+10*k,j+10*k),f.lineTo(c+8*k,j+11.5*k),f.lineTo(c+10*k,j+13*k),f.lineTo(c+10*k,j+10*k));f.fill();f.closePath()}g=!1}}},rotation:{set:function(a){if(void 0===
e||!e.isEqualTo(a))e=a,this.isVisible&&(g=!0)}},sideLen:{set:function(a){a!==b&&(b=a,this.isVisible&&(g=!0))}}});d.hide();return d});l("rotation_factory",[],function(){var a=Object.create(null,{isEqualTo:{value:function(a){return this.rectT.isEqualTo(a.rectT)&&this.cw===a.cw}},makesSense:{get:function(){return 0<this.rectT.widthT||0<this.rectT.heightT}},direction:{get:function(){return this.cw?-1:1}},angleRad:{get:function(){return this.direction*(this.rectT.isSquare?Math.PI/2:Math.PI)}},angleDeg:{get:function(){return this.direction*
(this.rectT.isSquare?90:180)}},inverse:{get:function(){var c=this.rectT,b=!this.cw;return Object.create(a,{rectT:{get:function(){return c}},cw:{get:function(){return b}}})}}});return Object.create(null,{create:{value:function(c,b){return Object.create(a,{rectT:{get:function(){return c}},cw:{get:function(){return b}}})}}})});l("tiles_canvas","boards rubber_band_canvas rot_anim_canvas arrow_canvas display_c_sys display_canvas_factory rotation_factory rect_t_factory".split(" "),function(a,c,b,g,e,d,
h,f){function i(){q=m===void 0?void 0:h.create(m,o)}var j,k,n,l=true,m,o,s,q,r=true;c.onDragStart=function(){g.show()};c.onDrag=function(a,b){if(m===void 0||!a.isEqualTo(m)||b!==o){m=a;o=b;l=true;i();g.rotation=q}};c.onDragEnd=function(){q!==void 0&&(q.makesSense&&!a.selected.isFinished)&&a.selected.rotate(q);a.selected.isFinished?c.hide():c.show();g.hide();m=void 0;i();l=true};return Object.create(d.create(),{animStep:{value:function(){var d;if(n===void 0||n!==a.selected){l=true;n=a.selected;d=true}else d=
false;if(k===void 0||!n.tiles.areEqualTo(k)){k=n.tiles.copy();if(!d){d=n.lastRotation;d!==null&&b.startAnim(d)}a.selected.isFinished?c.hide():c.show();g.hide();l=true}if(r){d=h.create(f.create([0,0],[k.widthT-1,k.heightT-1]),true);b.startAnim(d);r=false}if(s===void 0||s!==b.animIsRunning){l=true;s=b.animIsRunning}if(l){var i,q;d=n.sideLenT;i=document.getElementById("tilesCanvas");var o=i.getContext("2d"),J=n.isFinished&&!b.animIsRunning;i.height=i.width=j;J&&e.disableSpacing();for(i=0;i<d;i=i+1)for(q=
0;q<d;q=q+1){var p=o,u=[i,q],v=e.posFromPosT(u),w=k[u[0]][u[1]].color,C=c.isBeingDragged,x=e.tileSideLen,D=e.spacing===0?1:0;if(!b.animIsRunning||!b.isInRotRect(u)){p.globalAlpha=C&&c.isBeingDragged&&m!==void 0&&u[0]>=m[0][0]&&u[0]<=m[1][0]&&u[1]>=m[0][1]&&u[1]<=m[1][1]?0.5:1;p.fillStyle=w;p.fillRect(v[0],v[1],x+D,x+D)}}J&&e.enableSpacing();l=false}}},sideLen:{set:function(a){if(a!==j){j=a;l=true}}}})});l("display",["tiles_canvas","arrow_canvas","rubber_band_canvas","rot_anim_canvas","display_c_sys"],
function(a,c,b,g,e){var d=!1,h,f=!0;return Object.create(null,{animStep:{value:function(){if(d){if(f){var i=document.getElementById("display").style;d&&(i.display="block");i.width=h+"px";i.height=h+"px";f=!1}e.animStep();a.animStep();c.animStep();b.animStep();g.animStep()}}},sideLen:{set:function(d){d!==h&&(h=d,e.sideLen=h,a.sideLen=h,c.sideLen=h,b.sideLen=h,g.sideLen=h,f=!0)}},show:{value:function(){f=d=!0}}})});l("board_thumb_factory",["boards"],function(a){function c(a,c,e){return a.map(function(a){return a*
c/e})}return Object.create(null,{create:{value:function(b,g){var e=document.createElement("canvas"),d=!0,h=0,f=0,i=0;e.addEventListener("click",function(){a.selectedI=b;g()});return Object.create(null,{element:{get:function(){return e}},boardI:{set:function(a){a!==b&&(b=a,d=!0)}},sideLen:{set:function(a){a!==h&&(h=a,d=!0)}},x:{set:function(a){a!==f&&(f=a,d=!0)}},y:{set:function(a){a!==i&&(i=a,d=!0)}},animStep:{value:function(){if(d){var g=a[b],k=h,n=f,l=i,m=g.sideLenT,o=e.getContext("2d");e.width=
e.height=k;e.style.left=n-k/2+"px";e.style.top=l-k/2+"px";for(n=0;n<m;n+=1)for(l=0;l<m;l+=1){var s=o,q=[n,l],r=k,t=g.sideLenT,y=g.endTiles,p=c(q,r,t),r=r/t+1;s.fillStyle=y[q[0]][q[1]].color;s.fillRect(p[0],p[1],r,r)}d=!1}}}})}}})});l("boards_navigator",["boards","board_thumb_factory"],function(a,c){function b(){var a;d.forEach(function(b,c){a=c-p-h;b.sideLen=e/(4+2*Math.abs(a));b.x=a*(e/3)+e/2;b.y=e/8})}function g(b){return c.create(((l+b)%a.length+a.length)%a.length,function(){f=h-b;i=0<f?-1:1;k=
Date.now();j=!0;l=a.selectedI;d.forEach(function(b,c){b.boardI=((l+(c-p))%a.length+a.length)%a.length})})}var e,d=[],h=0,f,i,j=!1,k,l=0,o=!0,m=!0,p=2;return Object.create(null,{animStep:{value:function(){if(m){var a=document.getElementById("boardsNavigator"),c=a.style;c.width=e+"px";c.height=e/4+"px";o&&0<d.length&&(d.forEach(function(b){a.appendChild(b.element)}),o=!1);m=!1}d.forEach(function(a){a.animStep()});if(j){h=f+0.005*i*(Date.now()-k);if(0<i&&0<=h||0>i&&0>=h)h=0,j=!1;b();b()}}},activate:{value:function(){var a;
d.length=0;for(a=-p;a<=p;a+=1)d.push(g(a));b();m=!0}},width:{set:function(a){a!==e&&(e=a,b(),m=!0)}}})});l("hiscores_table",["util","boards"],function(a,c){function b(a){var b=document.createElement("td");b.appendChild(document.createTextNode(a));return b}function g(a){var c=document.createElement("tr");c.appendChild(b(a.name));c.appendChild(b(a.nRotations));return c}function e(){o.hiscores.nameInProposal=m.value}function d(){q&&(o.hiscores.nameInProposal=m.value,o.hiscores.saveProposal(),r=!0)}function h(){var a;
void 0!==p&&(a="submit button"+(q?"":" disabled"),p.className=a)}function f(){q=""!==m.value;h()}function i(a){f();13===a.keyCode&&d()}function j(a){var b=document.createElement("td");void 0===m&&(m=document.createElement("input"),m.type="text",m.maxLength=m.size=o.hiscores.maxNameLen,m.spellcheck=!1,m.addEventListener("blur",e),m.addEventListener("keyup",i),m.addEventListener("propertychange",f),m.addEventListener("input",f),m.addEventListener("paste",f));m.value=a;b.appendChild(m);f();return b}
function k(){var a=document.createElement("td");void 0===p&&(p=document.createElement("span"),p.appendChild(document.createTextNode("\u21b5")),p.addEventListener("click",d),h());a.appendChild(p);return a}function l(a){var b=document.createElement("tr");b.className="input";b.appendChild(j(a.name));b.appendChild(k());return b}var o,m,p,s,q=!1,r=!0;return Object.create(null,{animStep:{value:function(){c.selected!==o?(o=c.selected,s=o.isFinished,r=!0):o.isFinished!==s&&(s=o.isFinished,r=!0);if(r){var b=
document.getElementById("hiscoresTable");a.clear(b);o.hiscores.forEach(function(a,c,d){d?b.appendChild(l(a)):b.appendChild(g(a))});r=!1}}}})});l("rotations_navigator",["boards","util"],function(a,c){function b(a){return document.querySelector("#rotationsNavigator>."+a+".button")}function g(){f.undo()}function e(){f.redo()}function d(a,c){var d=a+" button";c&&(d+=" disabled");b(a).className=d}var h,f,i=!0;c.whenDocumentIsReady(function(){b("undo").addEventListener("click",g);b("redo").addEventListener("click",
e)});return Object.create(null,{animStep:{value:function(){a.selected!==f&&(f=a.selected,i=!0);f.nRotations!==h&&(h=f.nRotations,i=!0);i&&(document.getElementById("nRotations").textContent=h,d("undo",!f.undoIsPossible),d("redo",!f.redoIsPossible),i=!1)}}})});l("panel",["boards_navigator","hiscores_table","rotations_navigator"],function(a,c,b){var g,e,d=!0,h=!1;return Object.create(null,{animStep:{value:function(){if(h){if(d){var f=document.getElementById("panel").style;f.display="block";f.width=g+
"px";f.height=e+"px";f.left=e+"px";f.fontSize=Math.ceil(e/25)+"px";d=!1}a.animStep();c.animStep();b.animStep()}}},show:{value:function(){h=!0;a.activate();d=!0}},width:{set:function(b){b!==g&&(g=b,a.width=g,d=!0)}},height:{set:function(a){a!==e&&(e=a,d=!0)}}})});l("load_indicator",[],function(){var a=!0,c=!0,b;return Object.create(null,{animStep:{value:function(){if(a&&c){var g=document.getElementById("loadIndicator").style;g.fontSize=Math.ceil(b/20)+"px";g.top=g.left=Math.round(0.01*b);g.display=
"block";c=!1}}},hide:{value:function(){document.getElementById("loadIndicator").style.display="none";a=!1}},width:{set:function(a){a!==b&&(b=a,c=!0)}}})});l("vendor/rAF",[],function(){for(var a=0,c=["ms","moz","webkit","o"],b=0;b<c.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[c[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[b]+"CancelAnimationFrame"]||window[c[b]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=
function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),h=window.setTimeout(function(){b(c+d)},d);a=c+d;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})});l("game","display panel boards load_indicator util vendor/rAF".split(" "),function(a,c,b,g,e){function d(){g.animStep();a.animStep();c.animStep();window.requestAnimationFrame(d)}function h(){if(window.innerWidth/window.innerHeight<1.61803398875){f=window.innerWidth;i=Math.floor(f/1.61803398875)}else{i=
window.innerHeight;f=Math.floor(i*1.61803398875)}document.body.style.width=f+"px";document.body.style.height=i+"px";a.sideLen=i;c.width=f-i;c.height=i;g.width=f}var f,i;e.whenDocumentIsReady(function(){window.requestAnimationFrame(d);b.load(function(){c.show();a.show();g.hide()});h();window.addEventListener("resize",h)})});F(["game"])})();