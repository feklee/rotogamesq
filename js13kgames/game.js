(function(){var G,l,B=function(a,b){var e,h,f,d,g,c,j,i,k,m=b&&b.split("/"),p=o.map,n=p&&p["*"]||{};if(a&&"."===a.charAt(0)&&b){m=m.slice(0,m.length-1);a=m.concat(a.split("/"));for(i=0;i<a.length;i+=1)if(e=a[i],"."===e)a.splice(i,1),i-=1;else if(".."===e)if(1===i&&(".."===a[2]||".."===a[0]))break;else 0<i&&(a.splice(i-1,2),i-=2);a=a.join("/")}if((m||n)&&p){e=a.split("/");for(i=e.length;0<i;i-=1){h=e.slice(0,i).join("/");if(m)for(k=m.length;0<k;k-=1)if(f=p[m.slice(0,k).join("/")])if(f=f[h]){d=f;g=
i;break}if(d)break;!c&&(n&&n[h])&&(c=n[h],j=i)}!d&&c&&(d=c,g=j);d&&(e.splice(0,g,d),a=e.join("/"))}return a},H=function(a,b){return function(){return v.apply(void 0,K.call(arguments,0).concat([a,b]))}},L=function(a){return function(b){return B(b,a)}},M=function(a){return function(b){r[a]=b}},C=function(a){if(w.hasOwnProperty(a)){var b=w[a];delete w[a];I[a]=!0;x.apply(void 0,b)}if(!r.hasOwnProperty(a))throw Error("No "+a);return r[a]},J=function(a,b){var e,h,f=a.indexOf("!");-1!==f?(e=B(a.slice(0,
f),b),a=a.slice(f+1),a=(h=C(e))&&h.normalize?h.normalize(a,L(b)):B(a,b)):a=B(a,b);return{f:e?e+"!"+a:a,n:a,p:h}},N=function(a){return function(){return o&&o.config&&o.config[a]||{}}},x,v,r={},w={},o={},I={},K=[].slice;x=function(a,b,e,h){var f,d,g,c,j=[],i,h=h||a;if("function"===typeof e){b=!b.length&&e.length?["require","exports","module"]:b;for(c=0;c<b.length;c+=1)if(g=J(b[c],h),d=g.f,"require"===d)j[c]=H(a);else if("exports"===d)j[c]=r[a]={},i=!0;else if("module"===d)f=j[c]={id:a,uri:"",exports:r[a],
config:N(a)};else if(r.hasOwnProperty(d)||w.hasOwnProperty(d))j[c]=C(d);else if(g.p)g.p.load(g.n,H(h,!0),M(d),{}),j[c]=r[d];else if(!I[d])throw Error(a+" missing "+d);b=e.apply(r[a],j);if(a)if(f&&void 0!==f.exports&&f.exports!==r[a])r[a]=f.exports;else if(void 0!==b||!i)r[a]=b}else a&&(r[a]=e)};G=v=function(a,b,e,h,f){if("string"===typeof a)return C(J(a,b).f);a.splice||(o=a,b.splice?(a=b,b=e,e=null):a=void 0);b=b||function(){};"function"===typeof e&&(e=h,h=f);h?x(void 0,a,b,e):setTimeout(function(){x(void 0,
a,b,e)},15);return v};v.config=function(a){o=a;return v};l=function(a,b,e){b.splice||(e=b,b=[]);w[a]=[a,b,e]};l.amd={jQuery:!0};l("vendor/almond",[],function(){});l("tiles_factory",[],function(){function a(a,b,f){var d,g,c,j;if(b.widthT!==a.widthT||b.heightT!==a.heightT)return!1;for(d=0;d<b.length;d+=1){c=b[d];j=a[d];for(g=0;g<c.length;g+=1)if(!f(c[g],j[g]))return!1}return!0}var b;b=Object.create([],{areEqualTo:{value:function(e){return a(this,e,function(a,e){return a===e})}},colorsAreEqualTo:{value:function(e){return a(this,
e,function(a,e){return a.color===e.color})}},widthT:{get:function(){return this.length}},heightT:{get:function(){return 0<this.widthT?this[0].length:0}},copy:{value:function(){var a=Object.create(b);this.forEach(function(b){a.push(b.slice())});return a}}});return Object.create(null,{load:{value:function(a,h){var f=new Image;f.onload=function(){var a=document.createElement("canvas"),e=a.getContext("2d");a.width=f.width;a.height=f.height;e.drawImage(f,0,0);var c,j,i,k,a=Math.min(f.width,f.height),m=
e.getImageData(0,0,a,a).data,e=Object.create(b);for(j=0;j<a;j+=1){c=[];for(i=0;i<a;i+=1)k=4*(i*a+j),c.push({color:"rgb("+m[k]+","+m[k+1]+","+m[k+2]+")"});e.push(c)}h(e)};f.src=a}}})});l("hiscores_factory",[],function(){function a(a,f){var d=null;return Object.create(null,{forEach:{value:function(e){var c,f,i=a.length,k=!1;if(0===i&&null!==d)e(d,0,!0);else for(c=0;c<i;c+=1)f=a[c],null!==d&&d.nRotations<=f.nRotations&&!k?(e(d,c,!0),c-=1,i=Math.min(i,b-1),k=!0):e(f,c,!1)}},maxNameLen:{get:function(){return 8}},
nameInProposal:{set:function(a){null!==d&&(a=a.substring(0,this.maxNameLen),e=d.name=a)}},saveProposal:{value:function(){if(null!==d){a:{var e=d,c,j,i=!1;if(""!==e.name){if(0===a.length){a.push(e);break a}for(c=0;c<a.length;c+=1){j=a[c];if(e.name===j.name&&e.nRotations>=j.nRotations)break a;e.nRotations<=j.nRotations&&!i?(a.splice(c,0,e),i=!0):e.name===j.name&&a.splice(c,1)}}a.length=Math.min(a.length,b)}d=null;localStorage.setItem(f,JSON.stringify(a))}}},propose:{value:function(a){d={name:e,rotations:a.slice(),
nRotations:a.length}}},rmProposal:{value:function(){d=null}}})}var b=7,e="";return Object.create(null,{load:{value:function(e,b,d){var g;g=localStorage.getItem(b);g=null===g?null:JSON.parse(g);if(null!==g)d(a(g,b));else{var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&(200===c.status?d(a(JSON.parse(c.responseText),b)):d(a([])))};c.open("GET",e+"?"+Date.now(),!0);c.send()}}}})});l("board_factory",["tiles_factory","hiscores_factory"],function(a,b){function e(a){return void 0!==
a.tiles&&void 0!==a.endTiles&&void 0!==a.hiscores}function h(a,c){Object.defineProperty(a,"sideLenT",{value:a.tiles.length});c(a)}function f(a,c,e,b){return a[e][b-c]}function d(a,c,e,b,d){return a[d-e][c]}function g(a,c,e,b,d){return a[b-c][d-e]}function c(a,c,e){var b,d,f=c[0][0],g=c[0][1],i=c[1][0],c=c[1][1],j=i-f,h=c-g,k,l;k=[];for(d=f;d<=i;d+=1){b=[];for(l=g;l<=c;l+=1)b.push(a[d][l]);k.push(b)}for(b=f;b<=i;b+=1)for(d=g;d<=c;d+=1)a[b][d]=e(k,b-f,d-g,j,h)}function j(a,e){var b=e.rectT,i=e.cw;b.isSquare?
i?c(a,b,f):c(a,b,d):c(a,b,g)}function i(a,c){c.tiles.colorsAreEqualTo(c.endTiles)?a.isFinished||(a.isFinished=!0,c.hiscores.propose(a.rotations)):(a.isFinished=!1,c.hiscores.rmProposal())}var k;k=Object.create(null,{rotate:{value:function(a,c){a.rotations.push(c);a.futureRotations.length=0;j(this.tiles,c);i(a,this);a.lastRotation=c}},undo:{value:function(a){var c=a.rotations.pop();void 0!==c&&(a.futureRotations.push(c),j(this.tiles,c.inverse),i(a,this),a.lastRotation=c.inverse)}},redo:{value:function(a){var c=
a.futureRotations.pop();void 0!==c&&(a.rotations.push(c),j(this.tiles,c),i(a,this),a.lastRotation=c)}}});return Object.create(null,{load:{value:function(c,d){var f,g={rotations:[],futureRotations:[],lastRotation:null,isFinished:!1};f=Object.create(k,{rotate:{value:function(a){k.rotate.call(this,g,a)}},nRotations:{get:function(){return g.rotations.length}},undoIsPossible:{get:function(){return 0<g.rotations.length}},undo:{value:function(){k.undo.call(this,g)}},redoIsPossible:{get:function(){return 0<
g.futureRotations.length}},redo:{value:function(){k.redo.call(this,g)}},isFinished:{get:function(){return g.isFinished}},lastRotation:{get:function(){return g.lastRotation}}});a.load("boards/"+c+"/start.gif",function(a){Object.defineProperty(f,"tiles",{value:a});e(f)&&h(f,d)});a.load("boards/"+c+"/end.gif",function(a){Object.defineProperty(f,"endTiles",{value:a});e(f)&&h(f,d)});b.load("boards/"+c+"/hiscores.json","rotogamejs."+c+".hiscores",function(a){Object.defineProperty(f,"hiscores",{value:a});
e(f)&&h(f,d)})}}})});l("boards",["board_factory"],function(a){var b=0,e,h=["13","smiley","invaders","house","rgbcmy"];return e=Object.create([],{load:{value:function(b){this.length=h.length;h.forEach(function(d,g){a.load(d,function(a){e[g]=a;a:{for(a=0;a<h.length;a+=1)if(void 0===e[a]){a=!1;break a}a=!0}a&&b()})})}},selected:{get:function(){return this[b]}},selectedI:{get:function(){return b},set:function(a){b=a}}})});l("util",[],function(){return Object.create(null,{whenDocumentIsReady:{value:function(a){"complete"===
document.readyState?a():document.addEventListener("readystatechange",function(){"complete"===document.readyState&&a()})}},clear:{value:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)}}})});l("rect_t_factory",[],function(){var a,b;b=function(a,b){return a[0]===b[0]&&a[1]===b[1]};a=Object.create([],{isEqualTo:{value:function(a){return b(this[0],a[0])&&b(this[1],a[1])}},widthT:{get:function(){return this[1][0]-this[0][0]}},heightT:{get:function(){return this[1][1]-this[0][1]}},centerT:{get:function(){return[(this[0][0]+
this[1][0])/2,(this[0][1]+this[1][1])/2]}},contains:{value:function(a){var b=a[0],a=a[1];return b>=this[0][0]&&a>=this[0][1]&&b<=this[1][0]&&a<=this[1][1]}},isSquare:{get:function(){return this.widthT===this.heightT}}});return Object.create(null,{create:{value:function(b,h){var f=Object.create(a);f.push(b);f.push(h);return f}}})});l("display_c_sys",["boards"],function(a){function b(){var a;void 0!==h&&(a=h.sideLenT,d=g?0:0.05*e/a,f=(e-d*(a+1))/a)}var e,h,f=0,d=0,g=!1;return Object.create(null,{sideLen:{set:function(a){a!==
e&&(e=a,b())}},animStep:{value:function(){a.selected!==h&&(h=a.selected,b())}},posFromPosT:{value:function(a){return a.map(function(a){return a*(f+d)+d})}},posTFromPos:{value:function(a){return a.map(function(a){return(a-d)/(f+d)})}},decIfInSpacing:{value:function(a){return a.map(function(a){var c=a%(f+d);return 0<a&&c<d?a-c-f/2:a})}},incIfInSpacing:{value:function(a){return a.map(function(a){var c=a%(f+d);return 0<a&&c<d?a-c+d+f/2:a})}},posTInBounds:{value:function(a){return a.map(function(a){return Math.min(Math.max(a,
0),h.sideLenT-1)})}},tileSideLen:{get:function(){return f}},spacing:{get:function(){return d}},disableSpacing:{value:function(){g=!0;b()}},enableSpacing:{value:function(){g=!1;b()}}})});l("display_canvas_factory",[],function(){return Object.create(null,{create:{value:function(){var a=!0,b=!0;return Object.create(null,{visibilityNeedsToBeUpdated:{get:function(){return b}},isVisible:{get:function(){return a}},updateVisibility:{value:function(e){e.style.display=a?"block":"none";b=!1}},show:{value:function(){a||
(b=a=!0)}},hide:{value:function(){a&&(a=!1,b=!0)}}})}}})});l("rubber_band_canvas",["util","rect_t_factory","display_c_sys","display_canvas_factory"],function(a,b,e,h){function f(){var a=e.incIfInSpacing([Math.min(q[0],s[0]),Math.min(q[1],s[1])]),c=e.decIfInSpacing([Math.max(q[0],s[0]),Math.max(q[1],s[1])]),a=e.posTInBounds(e.posTFromPos(a).map(Math.floor)),c=e.posTInBounds(e.posTFromPos(c).map(Math.floor));u=b.create(a,c)}function d(){y=s[0]>q[0]}function g(a){s=q=a;f();d();z=A=!0;void 0!==F&&F()}
function c(a){s=a;f();d();z=!0;void 0!==D&&D(u,y)}function j(){A=!1;z=!0;q=s=[0,0];f();d();void 0!==o&&o()}function i(a){g([a.pageX,a.pageY])}function k(a){a.preventDefault();a=a.changedTouches;0<a.length&&g([a[0].pageX,a[0].pageY])}function m(a){A&&c([a.pageX,a.pageY])}function p(a){var b=a.changedTouches;a.preventDefault();A&&0<b.length&&c([b[0].pageX,b[0].pageY])}function n(){A&&j()}function l(a){a.preventDefault();A&&j()}var t,q=[0,0],s=[0,0],u=b.create([0,0],[0,0]),y,z=!0,A=!1,r=1,D,F,o;a.whenDocumentIsReady(function(){var a=
document.getElementById("rubberBandCanvas");a.addEventListener("mousedown",i);a.addEventListener("touchstart",k);window.addEventListener("mousemove",m);window.addEventListener("touchmove",p);window.addEventListener("mouseup",n);window.addEventListener("touchend",l);window.addEventListener("touchcancel",l)});return Object.create(h.create(),{animStep:{value:function(){var a=document.getElementById("rubberBandCanvas");this.visibilityNeedsToBeUpdated&&(this.updateVisibility(a),this.isVisible&&(z=!0));
if(z){var c=a.getContext("2d");a.height=a.width=t;r=0.005*t;c.strokeStyle="#fff";c.lineWidth=r;c.lineJoin="round";c.strokeRect(q[0],q[1],s[0]-q[0],s[1]-q[1]);z=!1}}},isBeingDragged:{get:function(){return A}},sideLen:{set:function(a){a!==t&&(t=a,z=!0)}},onDragStart:{set:function(a){F=a}},onDrag:{set:function(a){D=a}},onDragEnd:{set:function(a){o=a}}})});l("rot_anim_canvas",["boards","display_c_sys","display_canvas_factory"],function(a,b,e){var h,f,d,g,c,j,i,k,m;return Object.create(e.create(),{animStep:{value:function(){var a=
document.getElementById("rotAnimCanvas");this.visibilityNeedsToBeUpdated&&this.updateVisibility(a);if(d){i=j+0.004*k*(Date.now()-c);if(0>k?0>=i:0<=i)i=0;if(0>k?0>=i:0<=i)d=!1,this.hide();else{var e,m=a.getContext("2d");e=g[0][0];var t=g[0][1],q=g[1][0],s=g[1][1],u=b.posFromPosT(g.centerT),u=[u[0]+b.tileSideLen/2,u[1]+b.tileSideLen/2];a.width=a.height=h;m.save();m.translate(u[0],u[1]);m.rotate(i);for(a=e;a<=q;a+=1)for(e=t;e<=s;e+=1){var y=m,l=[a,e],r=u,o=b.posFromPosT(l),D=b.tileSideLen;y.fillStyle=
f[l[0]][l[1]].color;y.fillRect(o[0]-r[0],o[1]-r[1],D,D)}m.restore()}}}},sideLen:{set:function(a){h=a}},animIsRunning:{get:function(){return d}},isInRotRect:{value:function(a){return g.contains(a)}},startAnim:{value:function(b){m=a.selected;f=m.tiles.copy();g=b.rectT;d=!0;c=Date.now();k=-b.direction;j=b.angleRad;this.show()}}})});l("arrow_canvas",["display_c_sys","display_canvas_factory"],function(a,b){var e,h=!1,f,d;d=Object.create(b.create(),{animStep:{value:function(){var b=document.getElementById("arrowCanvas");
this.visibilityNeedsToBeUpdated&&(this.updateVisibility(b),this.isVisible&&(h=!0));if(h){var c=b.getContext("2d");b.height=b.width=e;if(void 0!==f&&f.makesSense){var d=f.angleDeg,i=a.posFromPosT(f.rectT[1]),b=i[0],i=i[1],k=a.tileSideLen/14;c.lineWidth=k;var m=0,p=90===d||-90===d?Math.PI/2:Math.PI;0<d?m-=Math.PI/8:p+=Math.PI/8;c.beginPath();c.arc(b+10*k,i+10*k,1.5*k,m,p);c.stroke();c.beginPath();90===d||180===d||-180===d?(d=-180===d?-3*k:0,c.moveTo(b+10*k+d,i+10*k),c.lineTo(b+13*k+d,i+10*k),c.lineTo(b+
11.5*k+d,i+8*k),c.lineTo(b+10*k+d,i+10*k)):(c.moveTo(b+10*k,i+10*k),c.lineTo(b+8*k,i+11.5*k),c.lineTo(b+10*k,i+13*k),c.lineTo(b+10*k,i+10*k));c.fill();c.closePath()}h=!1}}},rotation:{set:function(a){if(void 0===f||!f.isEqualTo(a))f=a,this.isVisible&&(h=!0)}},sideLen:{set:function(a){a!==e&&(e=a,this.isVisible&&(h=!0))}}});d.hide();return d});l("rotation_factory",[],function(){var a=Object.create(null,{isEqualTo:{value:function(a){return this.rectT.isEqualTo(a.rectT)&&this.cw===a.cw}},makesSense:{get:function(){return 0<
this.rectT.widthT||0<this.rectT.heightT}},direction:{get:function(){return this.cw?-1:1}},angleRad:{get:function(){return this.direction*(this.rectT.isSquare?Math.PI/2:Math.PI)}},angleDeg:{get:function(){return this.direction*(this.rectT.isSquare?90:180)}},inverse:{get:function(){var b=this.rectT,e=!this.cw;return Object.create(a,{rectT:{get:function(){return b}},cw:{get:function(){return e}}})}}});return Object.create(null,{create:{value:function(b,e){return Object.create(a,{rectT:{get:function(){return b}},
cw:{get:function(){return e}}})}}})});l("tiles_canvas","boards rubber_band_canvas rot_anim_canvas arrow_canvas display_c_sys display_canvas_factory rotation_factory rect_t_factory".split(" "),function(a,b,e,h,f,d,g,c){function j(){q=n===void 0?void 0:g.create(n,l)}var i,k,m,p=true,n,l,t,q,s=true;b.onDragStart=function(){h.show()};b.onDrag=function(a,b){if(n===void 0||!a.isEqualTo(n)||b!==l){n=a;l=b;p=true;j();h.rotation=q}};b.onDragEnd=function(){q!==void 0&&(q.makesSense&&!a.selected.isFinished)&&
a.selected.rotate(q);a.selected.isFinished?b.hide():b.show();h.hide();n=void 0;j();p=true};return Object.create(d.create(),{animStep:{value:function(){var d;if(m===void 0||m!==a.selected){p=true;m=a.selected;d=true}else d=false;if(k===void 0||!m.tiles.areEqualTo(k)){k=m.tiles.copy();if(!d){d=m.lastRotation;d!==null&&e.startAnim(d)}a.selected.isFinished?b.hide():b.show();h.hide();p=true}if(s){d=g.create(c.create([0,0],[k.widthT-1,k.heightT-1]),true);e.startAnim(d);s=false}if(t===void 0||t!==e.animIsRunning){p=
true;t=e.animIsRunning}if(p){var j,l;d=m.sideLenT;j=document.getElementById("tilesCanvas");var q=j.getContext("2d"),r=m.isFinished&&!e.animIsRunning;j.height=j.width=i;r&&f.disableSpacing();for(j=0;j<d;j=j+1)for(l=0;l<d;l=l+1){var E=q,o=[j,l],v=f.posFromPosT(o),w=k[o[0]][o[1]].color,B=b.isBeingDragged,x=f.tileSideLen,C=f.spacing===0?1:0;if(!e.animIsRunning||!e.isInRotRect(o)){E.globalAlpha=B&&b.isBeingDragged&&n!==void 0&&o[0]>=n[0][0]&&o[0]<=n[1][0]&&o[1]>=n[0][1]&&o[1]<=n[1][1]?0.5:1;E.fillStyle=
w;E.fillRect(v[0],v[1],x+C,x+C)}}r&&f.enableSpacing();p=false}}},sideLen:{set:function(a){if(a!==i){i=a;p=true}}}})});l("display",["tiles_canvas","arrow_canvas","rubber_band_canvas","rot_anim_canvas","display_c_sys"],function(a,b,e,h,f){var d=!1,g,c=!0;return Object.create(null,{animStep:{value:function(){if(d){if(c){var j=document.getElementById("display").style;d&&(j.display="block");j.width=g+"px";j.height=g+"px";c=!1}f.animStep();a.animStep();b.animStep();e.animStep();h.animStep()}}},sideLen:{set:function(d){d!==
g&&(g=d,f.sideLen=g,a.sideLen=g,b.sideLen=g,e.sideLen=g,h.sideLen=g,c=!0)}},show:{value:function(){c=d=!0}}})});l("board_thumb_factory",["boards"],function(a){function b(a,b,f){return a.map(function(a){return a*b/f})}return Object.create(null,{create:{value:function(e,h){var f=document.createElement("canvas"),d=!0,g=0,c=0,j=0;f.addEventListener("click",function(){a.selectedI=e;h()});return Object.create(null,{element:{get:function(){return f}},boardI:{set:function(a){a!==e&&(e=a,d=!0)}},sideLen:{set:function(a){a!==
g&&(g=a,d=!0)}},x:{set:function(a){a!==c&&(c=a,d=!0)}},y:{set:function(a){a!==j&&(j=a,d=!0)}},animStep:{value:function(){if(d){var i=a[e],h=g,m=c,l=j,n=i.sideLenT,o=f.getContext("2d");f.width=f.height=h;f.style.left=m-h/2+"px";f.style.top=l-h/2+"px";for(m=0;m<n;m+=1)for(l=0;l<n;l+=1){var t=o,q=[m,l],s=h,u=i.sideLenT,y=i.endTiles,r=b(q,s,u),s=s/u+1;t.fillStyle=y[q[0]][q[1]].color;t.fillRect(r[0],r[1],s,s)}d=!1}}}})}}})});l("boards_navigator",["boards","board_thumb_factory"],function(a,b){function e(){var a;
d.forEach(function(b,c){a=c-o-g;b.sideLen=f/(4+2*Math.abs(a));b.x=a*(f/3)+f/2;b.y=f/8})}function h(e){return b.create(((l+e)%a.length+a.length)%a.length,function(){c=g-e;j=0<c?-1:1;k=Date.now();i=!0;l=a.selectedI;d.forEach(function(b,c){b.boardI=((l+(c-o))%a.length+a.length)%a.length})})}var f,d=[],g=0,c,j,i=!1,k,l=0,p=!0,n=!0,o=2;return Object.create(null,{animStep:{value:function(){if(n){var a=document.getElementById("boardsNavigator"),b=a.style;b.width=f+"px";b.height=f/4+"px";p&&0<d.length&&(d.forEach(function(b){a.appendChild(b.element)}),
p=!1);n=!1}d.forEach(function(a){a.animStep()});if(i){g=c+0.005*j*(Date.now()-k);if(0<j&&0<=g||0>j&&0>=g)g=0,i=!1;e();e()}}},activate:{value:function(){var a;d.length=0;for(a=-o;a<=o;a+=1)d.push(h(a));e();n=!0}},width:{set:function(a){a!==f&&(f=a,e(),n=!0)}}})});l("hiscores_table",["util","boards"],function(a,b){function e(a){var b=document.createElement("td");b.appendChild(document.createTextNode(a));return b}function h(a){var b=document.createElement("tr");b.appendChild(e(a.name));b.appendChild(e(a.nRotations));
return b}function f(){p.hiscores.nameInProposal=n.value}function d(){q&&(p.hiscores.nameInProposal=n.value,p.hiscores.saveProposal(),s=!0)}function g(){var a;void 0!==o&&(a="submit button"+(q?"":" disabled"),o.className=a)}function c(){q=""!==n.value;g()}function j(a){c();13===a.keyCode&&d()}function i(a){var b=document.createElement("td");void 0===n&&(n=document.createElement("input"),n.type="text",n.maxLength=n.size=p.hiscores.maxNameLen,n.spellcheck=!1,n.addEventListener("blur",f),n.addEventListener("keyup",
j),n.addEventListener("propertychange",c),n.addEventListener("input",c),n.addEventListener("paste",c));n.value=a;b.appendChild(n);c();return b}function k(){var a=document.createElement("td");void 0===o&&(o=document.createElement("span"),o.appendChild(document.createTextNode("\u21b5")),o.addEventListener("click",d),g());a.appendChild(o);return a}function l(a){var b=document.createElement("tr");b.className="input";b.appendChild(i(a.name));b.appendChild(k());return b}var p,n,o,r,q=!1,s=!0;return Object.create(null,
{animStep:{value:function(){b.selected!==p?(p=b.selected,r=p.isFinished,s=!0):p.isFinished!==r&&(r=p.isFinished,s=!0);if(s){var c=document.getElementById("hiscoresTable");a.clear(c);p.hiscores.forEach(function(a,b,d){d?c.appendChild(l(a)):c.appendChild(h(a))});s=!1}}}})});l("rotations_navigator",["boards","util"],function(a,b){function e(a){return document.querySelector("#rotationsNavigator>."+a+".button")}function h(){c.undo()}function f(){c.redo()}function d(a,b){var c=a+" button";b&&(c+=" disabled");
e(a).className=c}var g,c,j=!0;b.whenDocumentIsReady(function(){e("undo").addEventListener("click",h);e("redo").addEventListener("click",f)});return Object.create(null,{animStep:{value:function(){a.selected!==c&&(c=a.selected,j=!0);c.nRotations!==g&&(g=c.nRotations,j=!0);j&&(document.getElementById("nRotations").textContent=g,d("undo",!c.undoIsPossible),d("redo",!c.redoIsPossible),j=!1)}}})});l("panel",["boards_navigator","hiscores_table","rotations_navigator"],function(a,b,e){var h,f,d=!0,g=!1;return Object.create(null,
{animStep:{value:function(){if(g){if(d){var c=document.getElementById("panel").style;c.display="block";c.width=h+"px";c.height=f+"px";c.left=f+"px";c.fontSize=Math.ceil(f/25)+"px";d=!1}a.animStep();b.animStep();e.animStep()}}},show:{value:function(){g=!0;a.activate();d=!0}},width:{set:function(b){b!==h&&(h=b,a.width=h,d=!0)}},height:{set:function(a){a!==f&&(f=a,d=!0)}}})});l("load_indicator",[],function(){var a=!0,b=!0,e;return Object.create(null,{animStep:{value:function(){if(a&&b){var h=document.getElementById("loadIndicator").style;
h.fontSize=Math.ceil(e/20)+"px";h.top=h.left=Math.round(0.01*e);h.display="block";b=!1}}},hide:{value:function(){document.getElementById("loadIndicator").style.display="none";a=!1}},width:{set:function(a){a!==e&&(e=a,b=!0)}}})});l("vendor/rAF",[],function(){for(var a=0,b=["ms","moz","webkit","o"],e=0;e<b.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[b[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[e]+"CancelAnimationFrame"]||window[b[e]+"CancelRequestAnimationFrame"];
window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var e=(new Date).getTime(),d=Math.max(0,16-(e-a)),g=window.setTimeout(function(){b(e+d)},d);a=e+d;return g});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})});l("game","display panel boards load_indicator util vendor/rAF".split(" "),function(a,b,e,h,f){function d(){h.animStep();a.animStep();b.animStep();window.requestAnimationFrame(d)}function g(){if(window.innerWidth/window.innerHeight<
1.61803398875){c=window.innerWidth;j=Math.floor(c/1.61803398875)}else{j=window.innerHeight;c=Math.floor(j*1.61803398875)}document.body.style.width=c+"px";document.body.style.height=j+"px";a.sideLen=j;b.width=c-j;b.height=j;h.width=c}var c,j;f.whenDocumentIsReady(function(){window.requestAnimationFrame(d);e.load(function(){b.show();a.show();h.hide()});g();window.addEventListener("resize",g)})});G(["game"])})();